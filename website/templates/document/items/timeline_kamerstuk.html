{% load openkamer %}
{% load document %}

{% with kamerstuk=item.obj %}

<a class="anchor" id="{{ kamerstuk.id_full }}"></a>
{% get_kamerstuk_timeline_bg_color kamerstuk as bgclass %}
<div class="cd-timeline-img text-center {{ bgclass }}">
  {% get_kamerstuk_icon_name kamerstuk as icon_name %}
  <span style="font-size:24px;" class="fa {{ icon_name }}"></span>
</div> <!-- cd-timeline-img -->

<div class="card card-accent-primary cd-timeline-content">

  <div class="card-header p-2">

      {% if kamerstuk.voting %}
      <span class="pr-2">
        {% with voting=kamerstuk.voting %}
        {% include "document/items/voting_result_small.html" %}
        {% endwith %}
      </span>
      {% endif %}

      <span class="font-sm font-weight-bold">
        <a id="kamerstuk-link-{{ kamerstuk.id }}" href="#">
          {% if kamerstuk.type_short != kamerstuk.type_long %}
            {{ kamerstuk.type_short|capfirst }}
          {% else %}
              {{ kamerstuk.type_long }}
          {% endif %}
        </a>
      </span>

      <script>
        $(function() {
          $("#kamerstuk-link-{{ kamerstuk.id }}").bind('click', function() {
            $.get(
              "{% url 'kamerstuk-html' kamerstuk.id_main kamerstuk.id_sub  %}",
              {
              },
              function(data) {
                $("#aside-container").html(data.html);
                $('body').removeClass('aside-menu-hidden');
              },
              "json"
            );
          });
        });
      </script>

      <span class="font-sm float-right">
        <span class="cd-date">
          <span class="font-sm font-weight-bold">{{ kamerstuk.document.date_published|date:"j F Y" }}</span>
        </span>
      </span>

  </div>

  {% if kamerstuk.type_short != kamerstuk.type_long %}
  <div class="card-body p-2">
    <a href="{% url 'kamerstuk' kamerstuk.id_main kamerstuk.id_sub %}">{{ kamerstuk.id_full }}</a>
    <span class="font-sm">{{ kamerstuk.type_long }}</span>
  </div>
  {% endif %}

  {% if is_person_timeline %}
  <div class="card-footer">
    <h6 class="small">Dossier: <a href="{% url 'dossier-timeline' kamerstuk.document.dossier.dossier_id %}">{{ kamerstuk.document.dossier.title|truncatechars:200 }}</a></h6>
  </div>
  {% endif %}

  <div class="card-footer p-0">
    {% with submitters=kamerstuk.document.submitters %}
    {% if submitters %}
        {% include "document/items/submitters_list.html" %}
    {% endif %}
    {% endwith %}

  </div>

  <div class="card-footer p-0 border-0">
    <span class="small">{% include "document/items/kamerstuk_modifications.html" %}</span>
  </div>

  {% if kamerstuk.voting %}
  <div class="card-footer p-0 border-0">
    {% with voting=kamerstuk.voting %}
    {% include "document/items/voting_result_bar_small.html" %}
    {% endwith %}
  </div>
  {% endif %}

  {% if item.besluit_cases %}
  <div class="card-body p-2">
    {% for case in item.besluit_cases %}
      <span class="font-sm">
      {% get_besluitenlijst_item_anchor case.besluit_item as item_anchor %}
      <strong>Commissie besluit</strong> - {{ case.besluit_item.besluiten_lijst.date_published }} -
      besluitenlijst <a href="{% url 'besluitenlijst' case.besluit_item.besluiten_lijst.activity_id %}#{{ item_anchor }}">{{ case.besluit_item.besluiten_lijst.activity_id }}</a><br/>
      <font class="text-info">{{ case.besluit_item.besluiten_lijst.commission }}</font><br/>
      {% for decision in case.decision_list %}
        {{ decision }}{% if not forloop.last %}<br/>{% endif %}
      {% endfor %}
      </span>
    {% endfor %}
  </div>
  {% endif %}

  <!--<div class="visible-xs visible-sm panel-footer panel-footer-timeline">-->
    <!--<h6 class="small">{{ kamerstuk.document.date_published|date:"j F Y" }}</h6>-->
  <!--</div>-->

</div> <!-- cd-timeline-content -->

{% endwith %}

{% extends "website/base.html" %}

{% block title %}Tijdlijn wetsvoorstel {{ dossier.dossier_id }} - {{ dossier.title }} {{ block.super }}{% endblock %}

{% load staticfiles %}
{% load openkamer %}

{% block headcontent %}
  <link rel="stylesheet" href="/static/css/timeline-1.1.css"> <!-- Resource style -->
  <script src="/static/js/modernizr.min.js"></script> <!-- Modernizr -->
{% endblock %}

{% block content %}

<div class="subnav subnav-default">
  <div class="container">
    <ul class="nav navbar-nav">
      <li class="active"><a href="{% url 'dossier-timeline' dossier.dossier_id %}">Verticale Tijdlijn</a></li>
      <li><a href="{% url 'dossier-timeline-horizontal' dossier.dossier_id %}">Horizontale Tijdlijn</a></li>
    </ul>
  </div>
</div>

<div class="card border-primary my-4">

  <div class="card-header bg-white text-center">
    {% if dossier.first_voorstel %}
    <h5><a href="{% url 'kamerstuk' dossier.first_voorstel.id_main dossier.first_voorstel.id_sub %}">{{ dossier.title }}</a></h5>
    {% else %}
    <h5>{{ dossier.title }}</h5>
    {% endif %}
  </div>

  <ul class="list-group list-group-flush">
    <li class="list-group-item">
      <span class="h6">{{ dossier.first_voorstel.document.date_published }}</span>
      <span class="h6 float-right">Wetsvoorstel {{ dossier.dossier_id }}</span>
    </li>
    <li class="list-group-item">
      <span class="h6">
        {% with submitters=dossier.first_voorstel.document.submitters %}
          {% include "document/items/submitters_list.html" %}
        {% endwith %}
      </span>
    </li>
  </ul>

  <div class="card-footer">
    <div class="row">
      <div class="col-8">
        <span class="h6">Bron: <a href="{{ dossier.url }}">{{ dossier.url }}</a></span>
      </div>
      <div class="col-4">
        <small class="float-right text-info">Bijgewerkt: {{ dossier.date_updated }}</small>
      </div>
    </div>
  </div>

</div>

<div class="row">
  <div class="col-lg-12" align="center">
    <h4>Tijdlijn</h4>
  </div>

  <div class="col-lg-12">
  <section id="cd-timeline" class="cd-container">

    <div class="cd-timeline-block">

      {% if dossier.voting %}
        {% get_dossier_status_color dossier as dossier_status_class %}
        {% get_dossier_status_icon dossier as dossier_status_icon %}
        <div class="cd-timeline-img text-center bg-{{ dossier_status_class }}">
          <span style="font-size:24px;" class="fa {{ dossier_status_icon }}"></span>
        </div>
        {% elif dossier.is_active %}
        <div class="cd-timeline-img text-center bg-info">
          <span style="font-size:24px;" class="fa fa-spinner" title="In behandeling"></span>
        </div>
        {% elif dossier.passed %}
        <div class="cd-timeline-img text-center bg-success">
          <span style="font-size:24px;" class="fa fa-check" title="Aangenomen"></span>
        </div>
        {% elif dossier.is_withdrawn %}
        <div class="cd-timeline-img text-center bg-danger">
          <span style="font-size:24px;" class="fa fa-undo" title="Ingetrokken"></span>
        </div>
        {% else %}
        <div class="cd-timeline-img text-center bg-warning">
          <span style="font-size:24px;" class="fa fa-stop-circle-o" title="Behandeld"></span>
        </div>
      {% endif %}

      <div class="card border-info cd-timeline-content">

        <div class="card-header bg-info text-white py-2">
          <span class="h5">
          {% if dossier.voting %}
            Dit wetsvoorstel is {{ dossier.get_status_display }}
          {% elif dossier.is_active %}
            Dit wetsvoorstel is in behandeling
          {% else %}
            Dit wetsvoorstel is niet meer in behandeling
          {% endif %}
          </span>
        </div>

        <div class="card-body py-2">
          {% if not dossier.voting and not dossier.is_active %}
            {% if dossier.is_withdrawn %}
              <h2>Voorstel is ingetrokken.</h2>
            {% else %}
              <h2>Er is niet over gestemd.</h2>
            {% endif %}
          {% endif %}

          {% if dossier.voting %}
            <h6>Stemming van {{ dossier.voting.date }}</h6>
          {% endif %}

          {% if dossier.decision %}
            <h6>Besluit: {{ dossier.decision }}</h6>
          {% else %}
            <h6>De huidige status is onbekend</h6>
          {% endif %}
        </div>

        {% if dossier.voting %}
        <div class="card-footer panel-footer-timeline">
          {% with voting=dossier.voting %}
            {% include "document/items/voting_result_list.html" %}
          {% endwith %}
        </div>
        <div class="card-footer panel-footer-timeline-vote-bar">
          {% with voting=dossier.voting %}
            {% include "document/items/voting_result_bar.html" %}
          {% endwith %}
        </div>
        {% endif %}

      </div>

    </div> <!-- cd-timeline-block -->

    {% for item in timeline_items %}

      <div class="cd-timeline-block">
        {% include item.template_name %}
      </div> <!-- cd-timeline-block -->

    {% endfor %}
  </section>
  </div>

</div>

<script src="{% static 'js/timeline.js' %}"></script>

{% endblock %}

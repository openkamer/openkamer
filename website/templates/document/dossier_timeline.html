{% extends "website/base.html" %}

{% block title %}Tijdlijn wetsvoorstel {{ dossier.dossier_id }} - {{ dossier.title }} {{ block.super }}{% endblock %}

{% load staticfiles %}
{% load openkamer %}

{% block headcontent %}
  <link rel="stylesheet" href="/static/css/timeline-1.1.css"> <!-- Resource style -->
  <script src="/static/js/modernizr.min.js"></script> <!-- Modernizr -->
{% endblock %}

{% block content %}

<div class="subnav subnav-default">
  <div class="container">
    <ul class="nav navbar-nav">
      <li class="active"><a href="{% url 'dossier-timeline' dossier.dossier_id %}">Verticale Tijdlijn</a></li>
      <li><a href="{% url 'dossier-timeline-horizontal' dossier.dossier_id %}">Horizontale Tijdlijn</a></li>
    </ul>
  </div>
</div>

<div class="row">
  <div class="col-lg-12">

    <div class="card card-accent-primary">

      <div class="card-header p-2">
        <span class="float-left font-sm font-weight-bold">
          {{ dossier.dossier_id }}
        </span>
        <span class="float-right font-sm font-weight-bold">
          {{ dossier.last_date }}
        </span>
      </div>

      <div class="card-header text-center bg-white py-2">
        <span class="font-md font-weight-bold">
          <a href="{% url 'dossier-timeline' dossier.dossier_id %}">
            {{ dossier.short_title|capfirst }}
          </a>
        </span>
      </div>

      <div class="card-body py-2">
        {% if dossier.first_voorstel %}
        <span class="">{{ dossier.title }}</span>
        {% else %}
          <span class="">{{ dossier.title }}</span>
        {% endif %}
      </div>

      <div class="card-footer p-0">
        <div class="card-group">
          {% with submitters=dossier.first_voorstel.document.submitters %}
            {% include "document/items/submitters_list.html" %}
          {% endwith %}
        </div>
      </div>

      <div class="card-body">
        <div class="h6">Bron: <a href="{{ dossier.url }}">{{ dossier.url }}</a></div>
        <div class="font-sm">Bijgewerkt: {{ dossier.date_updated }}</div>
      </div>

    </div>

  </div>
</div>

<div class="row">
  <div class="col-lg-12" align="center">
    <h4>Tijdlijn</h4>
  </div>

  <div class="col-lg-12">
  <section id="cd-timeline" class="cd-container">

    <div class="cd-timeline-block">

      {% if dossier.voting %}
        {% get_dossier_status_color dossier as dossier_status_class %}
        {% get_dossier_status_icon dossier as dossier_status_icon %}
        <div class="cd-timeline-img text-center bg-{{ dossier_status_class }}">
          <span style="font-size:24px;" class="fa {{ dossier_status_icon }}"></span>
        </div>
        {% elif dossier.is_active %}
        <div class="cd-timeline-img text-center bg-info">
          <span style="font-size:24px;" class="fa fa-spinner" title="In behandeling"></span>
        </div>
        {% elif dossier.passed %}
        <div class="cd-timeline-img text-center bg-success">
          <span style="font-size:24px;" class="fa fa-check" title="Aangenomen"></span>
        </div>
        {% elif dossier.is_withdrawn %}
        <div class="cd-timeline-img text-center bg-danger">
          <span style="font-size:24px;" class="fa fa-undo" title="Ingetrokken"></span>
        </div>
        {% else %}
        <div class="cd-timeline-img text-center bg-warning">
          <span style="font-size:24px;" class="fa fa-stop-circle-o" title="Behandeld"></span>
        </div>
      {% endif %}

      <div class="card {% if dossier_status_class %} card-accent-{{ dossier_status_class }}{% endif %} cd-timeline-content">

        <div class="card-header p-2">
          <span class="h6">
            {% if dossier.voting %}
              Dit wetsvoorstel is {{ dossier.get_status_display }}
            {% elif dossier.is_active %}
              Dit wetsvoorstel is in behandeling.
            {% else %}
              Dit wetsvoorstel is niet meer in behandeling.
            {% endif %}
          </span>
        </div>

        <div class="card-body p-2">
          {% if not dossier.voting and not dossier.is_active %}
          <span class="h6">
            {% if dossier.is_withdrawn %}
              Voorstel is ingetrokken.
            {% else %}
              Er is niet over gestemd.
            {% endif %}
          </span>
          {% endif %}

          {% if dossier.voting %}
          <span class="h6">
            Stemming van {{ dossier.voting.date }}
          </span>
          {% endif %}

          {% if dossier.decision %}
          <br/>
          <span class="h6">
            Besluit: {{ dossier.decision }}
          {% else %}
            De huidige status is onbekend
          </span>
          {% endif %}
        </div>

        {% if dossier.voting %}
        <div class="card-footer p-2">
          {% with voting=dossier.voting %}
            {% include "document/items/voting_result_list.html" %}
          {% endwith %}
        </div>

        <div class="card-footer p-0">
          {% with voting=dossier.voting %}
            {% include "document/items/voting_result_bar.html" %}
          {% endwith %}
        </div>
        {% endif %}

      </div>

    </div> <!-- cd-timeline-block -->

    {% for item in timeline_items %}

      <div class="cd-timeline-block">
        {% include item.template_name %}
      </div> <!-- cd-timeline-block -->

    {% endfor %}
  </section>
  </div>

</div>

<script src="{% static 'js/timeline.js' %}"></script>

{% endblock %}

{% block sidebar %}

    <!--<ul class="nav">-->
    <!--<li class="nav-title">Kamerstukken</li>-->
    <!--{% for kamerstuk in dossier.kamerstukken.reverse %}-->
      <!--<li class="nav-item">-->
        <!--<a class="nav-link font-sm" href="{% url 'parties' %}">-->
          <!--<i class="fa fa-file"></i> {{ kamerstuk.type_short }}-->
        <!--</a>-->
      <!--</li>-->
    <!--{% endfor %}-->
    <!--</ul>-->

{% endblock %}